(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(1),s=n.n(o),i=n(8),r=n.n(i),c=(n(15),n(9)),u=n(2),l=(n(16),n.p+"static/media/mesto_logo.a307e1c4.svg");var p=function(){return Object(a.jsx)("header",{className:"header",children:Object(a.jsx)("div",{className:"logo header__logo",children:Object(a.jsx)("img",{className:"logo__img",src:l,alt:"\u041f\u0440\u043e\u0435\u043a\u0442 \u041c\u0435\u0441\u0442\u043e"})})})},d=s.a.createContext();var _=function(e){var t=s.a.useContext(d),n=e.card.owner._id===t._id,o=e.card.likes.some((function(e){return e._id===t._id}));return Object(a.jsxs)("li",{className:"place",children:[Object(a.jsx)("div",{className:"place__img-container",children:Object(a.jsx)("img",{className:"place__img",src:e.card.link,alt:e.card.name,onClick:function(){return e.onCardClick(e.card)}})}),Object(a.jsxs)("div",{className:"place__description",children:[Object(a.jsx)("h2",{className:"place__title",children:e.card.name}),Object(a.jsxs)("div",{className:"place__like-container",children:[Object(a.jsx)("button",{className:"place__like-button ".concat(o&&"place__like-button_liked"),type:"button",onClick:function(){return e.onCardLike(e.card)}}),Object(a.jsx)("p",{className:"place__like-counter",children:e.card.likes.length})]})]}),Object(a.jsx)("button",{className:"place__delete-button ".concat(!n&&"place__delete-button_invisible"),type:"button",onClick:function(){return e.onCardDelete(e.card)}})]})};var m=function(e){var t=s.a.useContext(d);return Object(a.jsxs)("main",{className:"main",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"person",children:[Object(a.jsxs)("div",{className:"person__avatar-container",children:[Object(a.jsx)("div",{className:"person__avatar-img-container",children:Object(a.jsx)("img",{className:"person__avatar",src:t.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440"})}),Object(a.jsx)("div",{onClick:e.onEditAvatar,className:"person__avatar-button"})]}),Object(a.jsxs)("div",{className:"person__edit",children:[Object(a.jsxs)("div",{className:"person__description",children:[Object(a.jsx)("h1",{className:"person__name",children:t.name}),Object(a.jsx)("p",{className:"person__passion",children:t.about})]}),Object(a.jsx)("button",{onClick:e.onEditProfile,className:"person__edit-button",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})]}),Object(a.jsx)("button",{onClick:e.onAddPlace,className:"add-button",type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]}),Object(a.jsx)("section",{children:Object(a.jsx)("ul",{className:"places",children:e.cards.map((function(t,n){return Object(a.jsx)(_,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})})]})};var h=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var j=function(e){return Object(a.jsx)("div",{className:"popup popup_place-view ".concat(e.isOpen&&"popup_opened"),onClick:function(t){t.target===t.currentTarget&&e.onClose()},children:Object(a.jsxs)("figure",{className:"popup__figure",children:[Object(a.jsx)("img",{className:"popup__place-image",src:"".concat(e.card.link),alt:"".concat(e.card.name)}),Object(a.jsx)("figcaption",{className:"popup__place-caption",children:e.card.name}),Object(a.jsx)("button",{className:"popup__close popup__close_place-view",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose})]})})},b=n(5),f=n(6),v=new(function(){function e(t){var n=t.baseUrl,a=t.token;Object(b.a)(this,e),this._baseUrl=n,this._token=a}return Object(f.a)(e,[{key:"getUserInfo",value:function(){return fetch(this._baseUrl+"/users/me",{headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getInitialCards",value:function(){return fetch(this._baseUrl+"/cards",{headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"editUserInfo",value:function(e){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"addNewCard",value:function(e){return fetch(this._baseUrl+"/cards",{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"likeToggleCard",value:function(e,t){return e?fetch(this._baseUrl+"/cards/likes/"+t,{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})):fetch(this._baseUrl+"/cards/likes/"+t,{method:"PUT",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"changeAvatar",value:function(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-18",token:"7d3b332b-dc1e-49e3-90aa-8e33833ea304"}),O=new(function(){function e(t){var n=t.formSelector,a=t.inputSelector,o=t.submitButtonSelector,s=t.inactiveButtonClass,i=t.inputErrorClass,r=t.errorSelector;Object(b.a)(this,e),this._formSelector=n,this._inputSelector=a,this._submitButtonSelector=o,this._inactiveButtonClass=s,this._inputErrorClass=i,this._errorSelector=r}return Object(f.a)(e,[{key:"selectForm",value:function(e){this._validatedFormElement=document.querySelector(e),this._submitButton=this._validatedFormElement.querySelector(this._submitButtonSelector),this._inputElements=Array.from(this._validatedFormElement.querySelectorAll(this._inputSelector))}},{key:"_showInputError",value:function(e){e.classList.add(this._inputErrorClass),this._validatedFormElement.querySelector("#".concat(e.id,"-error")).textContent=e.validationMessage}},{key:"_hideInputError",value:function(e){e.classList.remove(this._inputErrorClass),this._validatedFormElement.querySelector("#".concat(e.id,"-error")).textContent=""}},{key:"_isValid",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_hasInvalidInput",value:function(){return this._inputElements.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass)):(this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButtonClass))}},{key:"clearPopupFromErrors",value:function(){var e=this;0!==this._inputElements.length&&(this._inputElements.forEach((function(t){e._hideInputError(t)})),this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass))}},{key:"validateForm",value:function(){var e=this;0!==this._inputElements.length&&(this._validatedFormElement.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState(),this._inputElements.forEach((function(t){t.addEventListener("input",(function(){e._isValid(t),e._toggleButtonState()}))})))}}]),e}())({formSelector:".popup__container",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__submit_disabled",inputErrorClass:"popup__input_state_error",errorSelector:".error"});var x=function(e){return s.a.useEffect((function(){e.isOpen&&(O.selectForm(".popup__container_".concat(e.name)),O.validateForm(),O.clearPopupFromErrors())}),[e.isOpen,e.name]),Object(a.jsx)("div",{className:"popup ".concat(e.isOpen&&"popup_opened"," popup_").concat(e.name),onClick:function(t){t.target===t.currentTarget&&e.onClose()},children:Object(a.jsxs)("form",{onSubmit:function(t){return e.onSubmit(t)},className:"popup__container popup__container_".concat(e.name),name:"".concat(e.name,"PopupForm"),noValidate:!0,children:[Object(a.jsx)("h2",{className:"popup__title",children:e.title}),Object(a.jsxs)("fieldset",{className:"popup__content",children:[e.children,Object(a.jsx)("button",{className:"popup__submit",type:"submit",children:e.buttonText})]}),Object(a.jsx)("button",{onClick:function(){e.onClose()},className:"popup__close popup__close_".concat(e.name),type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})]})})};var C=function(e){var t=s.a.useState(""),n=Object(u.a)(t,2),o=n[0],i=n[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],p=c[1],_=s.a.useContext(d);return s.a.useEffect((function(){i(_.name),p(_.about)}),[_,e.isOpen]),Object(a.jsxs)(x,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:l})},children:[Object(a.jsx)("input",{onChange:function(e){i(e.target.value)},value:o,id:"personName",className:"popup__input popup__name_profile",name:"popupInputName",type:"text",minLength:"2",maxLength:"40",required:!0,placeholder:"\u0418\u043c\u044f"}),Object(a.jsx)("span",{id:"personName-error",className:"error"}),Object(a.jsx)("input",{onChange:function(e){p(e.target.value)},value:l,id:"personPassion",className:"popup__input popup__passion_profile",name:"popupInputPassion",type:"text",minLength:"2",maxLength:"200",required:!0,placeholder:"\u041e \u0441\u0435\u0431\u0435"}),Object(a.jsx)("span",{id:"personPassion-error",className:"error"})]})};var k=function(e){var t=s.a.useRef();return e.isOpen&&(t.current.value=""),Object(a.jsxs)(x,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar(t.current.value),t.current.value=""},children:[Object(a.jsx)("input",{ref:t,id:"avatarLink",className:"popup__input popup__link_avatar",name:"popupInputAvatarLink",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440"}),Object(a.jsx)("span",{id:"avatarLink-error",className:"error"})]})};var g=function(e){var t=s.a.useState(""),n=Object(u.a)(t,2),o=n[0],i=n[1],r=s.a.useState(""),c=Object(u.a)(r,2),l=c[0],p=c[1];return s.a.useEffect((function(){e.isOpen&&(i(""),p(""))}),[e.isOpen]),Object(a.jsxs)(x,{name:"place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:o,link:l})},children:[Object(a.jsx)("input",{onChange:function(e){i(e.target.value)},id:"placeName",className:"popup__input popup__name_place",name:"popupInputPlace",type:"text",minLength:"2",maxLength:"30",required:!0,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:o}),Object(a.jsx)("span",{id:"placeName-error",className:"error"}),Object(a.jsx)("input",{onChange:function(e){p(e.target.value)},id:"placeLink",className:"popup__input popup__link_place",name:"popupInputLink",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",value:l}),Object(a.jsx)("span",{id:"placeLink-error",className:"error"})]})};var N=function(e){return Object(a.jsx)(x,{name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onConfirm()}})};var y=function(){var e=s.a.useState(!1),t=Object(u.a)(e,2),n=t[0],o=t[1],i=s.a.useState(!1),r=Object(u.a)(i,2),l=r[0],_=r[1],b=s.a.useState(!1),f=Object(u.a)(b,2),O=f[0],x=f[1],y=s.a.useState(!1),S=Object(u.a)(y,2),E=S[0],P=S[1],L=s.a.useState(!1),T=Object(u.a)(L,2),B=T[0],I=T[1];function U(){x(!1),o(!1),_(!1),P(!1),I(!1),M({})}var F=s.a.useState({about:"",avatar:"",cohort:"",name:"",_id:"75afb32823f9c1dc44155bd8"}),A=Object(u.a)(F,2),D=A[0],w=A[1];s.a.useEffect((function(){v.getUserInfo().then((function(e){w(e)})).catch((function(e){return console.log(e)}))}),[]);var q=s.a.useState({}),z=Object(u.a)(q,2),J=z[0],M=z[1],V=s.a.useState([]),H=Object(u.a)(V,2),R=H[0],G=H[1];return s.a.useEffect((function(){v.getInitialCards().then((function(e){G(e)})).catch((function(e){return console.log(e)}))}),[]),Object(a.jsx)(d.Provider,{value:D,children:Object(a.jsx)("div",{className:"body",children:Object(a.jsxs)("div",{className:"page body__page",children:[Object(a.jsx)(p,{}),Object(a.jsx)(m,{onEditProfile:function(){o(!0)},onAddPlace:function(){_(!0)},onEditAvatar:function(){x(!0)},onCardClick:function(e){M(e),P(!0)},cards:R,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===D._id}));v.likeToggleCard(t,e._id).then((function(t){var n=R.map((function(n){return n._id===e._id?t:n}));G(n)})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){M(e),I(!0)}}),Object(a.jsx)(h,{}),Object(a.jsx)(C,{isOpen:n,onClose:U,onUpdateUser:function(e){v.editUserInfo(e).then((function(e){w(e),U()})).catch((function(e){return console.log(e)})).finally(U())}}),Object(a.jsx)(g,{isOpen:l,onClose:U,onAddPlace:function(e){v.addNewCard(e).then((function(e){G([e].concat(Object(c.a)(R)))})).catch((function(e){return console.log(e)})).finally(U())}}),Object(a.jsx)(k,{isOpen:O,onClose:U,onUpdateAvatar:function(e){v.changeAvatar(e).then((function(e){w(e)})).catch((function(e){return console.log(e)})).finally(U())}}),Object(a.jsx)(j,{isOpen:E,card:J,onClose:U}),Object(a.jsx)(N,{isOpen:B,onClose:U,onConfirm:function(){return e=J,void v.deleteCard(e._id).then((function(t){var n=R.filter((function(t){return t._id!==e._id}));G(n)})).catch((function(e){return console.log(e)})).finally(U());var e}})]})})})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),s(e),i(e)}))};r.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(y,{})}),document.getElementById("root")),S()}},[[17,1,2]]]);
//# sourceMappingURL=main.c738d927.chunk.js.map